@page "/test"

@using Microsoft.Extensions.Options
@using NorthWind.BlazingPizza.Frontend.BusinessObjects.Agregates
@using NorthWind.BlazingPizza.Frontend.BusinessObjects.Interfaces.GetToppings
@using NorthWind.BlazingPizza.Frontend.BusinessObjects.Options
@using NorthWind.BlazingPizza.Frontend.ViewModels.GetSpecials


@inject IOptions<BlazingPizzaOptions> Options
@inject GetSpecialsViewModel ViewModel
@inject IGetToppingsModel ToppingsModel

@if(Pizza!=null)
{
	<ConfigurePizzaDialog CustomPizza="Pizza" />
}

@code {
	CustomPizza Pizza { get; set; }

	public override async Task OnInitializedAsync()
	{
		await ViewModel.GetSpecialsAsync();
		var Toppings = await ToppingsModel.GetToppingsAsync();
		Pizza = new CustomPizza(
			ViewModel.Specials.First(), Options.Value);

		Pizza.AddTopping(Toppings.ElementAt(0));
		Pizza.AddTopping(Toppings.ElementAt(1));
		Pizza.AddTopping(Toppings.ElementAt(2));
	}
}